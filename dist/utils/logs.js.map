{"version":3,"file":"logs.js","sourceRoot":"/","sources":["utils/logs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yDAAqE;AA0CrE,6EAA6E;AACtE,MAAM,GAAG,GAAG,KAAK,EAAC,IAAS,EAAE,MAAsB,EAAE,EAAE;IAC7D,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI;QAAE,OAAO;IAChC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,aAAa;QAAE,OAAO;IACzC,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,QAAQ;SACnC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC;SAClC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,2CAA2C,EAAE,CAAC,CAAC,CAAC,CAAC;IAC9E,IAAI,CAAC,OAAO;QAAE,OAAO,OAAO,CAAC,KAAK,CAAC,yCAAyC,CAAC,CAAC;IAC9E,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;QACzB,OAAO,CAAC,IAAI,KAAK,wBAAW,CAAC,EAAE;QAC/B,OAAO,CAAC,IAAI,KAAK,wBAAW,CAAC,aAAa;QAC1C,OAAO,CAAC,IAAI,KAAK,wBAAW,CAAC,YAAY;QAAE,OAAO,OAAO,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;IAErF,MAAM,OAAO,GAAG,CAAC,MAAO,OAAuB,CAAC,aAAa,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC;QACtF,MAAO,OAAuB,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAAE,CAAC,CAAC;IAE3E,IAAI,IAAI,CAAC,OAAO,KAAK,cAAc,EAAE;QACpC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,0BAA0B,IAAI,CAAC,eAAe,yBAAyB,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC;QAE5I,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,gBAAgB;YAC1B,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IACD,IAAI,IAAI,CAAC,OAAO,KAAK,aAAa,EAAE;QACnC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CACd,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,2BAA2B,IAAI,CAAC,QAAQ,OAAO,IAAI,CAAC,eAAe,YAAY,MAAM,CAAC,MAAM,CAC9H,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CACnE,cAAc,CACf,CAAC;QACH,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,gBAAgB;YAC1B,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IAED,IAAI,IAAI,CAAC,OAAO,KAAK,aAAa,EAAE;QACnC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CACd,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,0BAA0B,IAAI,CAAC,QAAQ,OAAO,IAAI,CAAC,eAAe,yBACpG,IAAI,CAAC,MACN,YAAY,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,cAAc,CAClG,CAAC;QAEH,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,eAAe;YACzB,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IAED,IAAI,IAAI,CAAC,OAAO,KAAK,cAAc,EAAE;QACpC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CACd,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,2BAA2B,IAAI,CAAC,QAAQ,UAAU,MAAM,CAAC,MAAM,CACjG,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,CACnE,+BAA+B,IAAI,CAAC,aAAa,EAAE,CACpD,CAAC;QAEH,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,gBAAgB;YAC1B,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IAED,IAAI,IAAI,CAAC,OAAO,KAAK,WAAW,EAAE;QACjC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CACd,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,cAAc,IAAI,CAAC,MAAM,CAAC,EAAE,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,qBAAqB,IAAI,CAAC,QAAQ,OAAO,IAAI,CAAC,eAAe,IAAI,CACpJ,CAAC;QAEH,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,YAAY;YACtB,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;IACD,IAAI,IAAI,CAAC,OAAO,KAAK,aAAa,EAAE;QACnC,MAAM,KAAK,GAAG,IAAI,oBAAO,CAAC,YAAY,EAAE;aACtC,QAAQ,CAAC,SAAS,CAAC;aACnB,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,EAAE,CAAC;aACzE,cAAc,CACd,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,gBAAgB,IAAI,CAAC,MAAM,CAAC,EAAE,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,uBAAuB,IAAI,CAAC,QAAQ,OAAO,IAAI,CAAC,eAAe,IAAI,CACxJ,CAAC;QACH,OAAO;aACL,IAAI,CAAC;YACL,QAAQ,EAAE,cAAc;YACxB,SAAS,EAAE,iCAAiC;YAC5C,MAAM,EAAE,CAAC,KAAK,CAAC;SACf,CAAC;aACD,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;KAC/B;AACF,CAAC,CAAC;AApHW,QAAA,GAAG,OAoHd;AAEF;;;;;EAKE","sourcesContent":["import Discord, { ChannelType, TextChannel, User } from \"discord.js\";\nimport {ExtendedClient} from \"../structure\";\n\n/*\nCopyright 2023 Sayrix (github.com/Sayrix)\n\nLicensed under the Creative Commons Attribution 4.0 International\nplease check https://creativecommons.org/licenses/by/4.0 for more informations.\n*/\n\ntype log = {\n\tLogType: \"ticketCreate\"\n\tuser: User\n\tticketChannelId?: string;\n\treason?: string;\n} | {\n\tLogType: \"ticketClaim\" | \"ticketClose\"\n\tuser: User\n\tticketChannelId?: string;\n\tticketId?: string | number;\n\treason?: string;\n\tticketCreatedAt: number | bigint;\n} | {\n\tLogType: \"ticketDelete\"\n\tuser: User\n\tticketChannelId?: string;\n\tticketId?: string | number;\n\treason?: string;\n\tticketCreatedAt: number | bigint;\n\ttranscriptURL?: string;\n\n} | {\n\tLogType: \"userAdded\" | \"userRemoved\"\n\tuser: User;\n\ttarget: {\n\t\tid?: string\n\t};\n\tticketChannelId?: string;\n\treason?: string;\n\tticketId?: string | number;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars, no-unused-vars\nexport const log = async(logs: log, client: ExtendedClient) => {\n\tif (!client.config.logs) return;\n\tif (!client.config.logsChannelId) return;\n\tconst channel = await client.channels\n\t\t.fetch(client.config.logsChannelId)\n\t\t.catch((e) => console.error(\"The channel to log events is not found!\\n\", e));\n\tif (!channel) return console.error(\"The channel to log events is not found!\");\n\tif (!channel.isTextBased() ||\n\t\tchannel.type === ChannelType.DM ||\n\t\tchannel.type === ChannelType.PrivateThread ||\n\t\tchannel.type === ChannelType.PublicThread) return console.error(\"Invalid Channel!\");\n\n\tconst webhook = (await (channel as TextChannel).fetchWebhooks()).find((wh) => wh.token) ?? \n\t\tawait (channel as TextChannel).createWebhook({ name: \"Ticket Bot Logs\" });\n\n\tif (logs.LogType === \"ticketCreate\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#3ba55c\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(`${logs.user.tag} (<@${logs.user.id}>) Created a ticket (<#${logs.ticketChannelId}>) with the reason: \\`${logs.reason}\\``);\n\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"Ticket Created\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/M38ZmjM.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n\tif (logs.LogType === \"ticketClaim\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#faa61a\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(\n\t\t\t\t`${logs.user.tag} (<@${logs.user.id}>) Claimed the ticket n째${logs.ticketId} (<#${logs.ticketChannelId}>) after ${client.msToHm(\n\t\t\t\t\tnew Date(Number(BigInt(Date.now()) - BigInt(logs.ticketCreatedAt)))\n\t\t\t\t)} of creation`\n\t\t\t);\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"Ticket Claimed\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/qqEaUyR.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n\n\tif (logs.LogType === \"ticketClose\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#ed4245\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(\n\t\t\t\t`${logs.user.tag} (<@${logs.user.id}>) Closed the ticket n째${logs.ticketId} (<#${logs.ticketChannelId}>) with the reason: \\`${\n\t\t\t\t\tlogs.reason\n\t\t\t\t}\\` after ${client.msToHm(Number(BigInt(Date.now()) - BigInt(logs.ticketCreatedAt)))} of creation`\n\t\t\t);\n\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"Ticket Closed\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/5ShDA4g.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n\n\tif (logs.LogType === \"ticketDelete\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#ed4245\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(\n\t\t\t\t`${logs.user.tag} (<@${logs.user.id}>) Deleted the ticket n째${logs.ticketId} after ${client.msToHm(\n\t\t\t\t\tnew Date(Number(BigInt(Date.now()) - BigInt(logs.ticketCreatedAt)))\n\t\t\t\t)} of creation\\n\\nTranscript: ${logs.transcriptURL}`\n\t\t\t);\n\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"Ticket Deleted\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/obTW2BS.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n\n\tif (logs.LogType === \"userAdded\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#3ba55c\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(\n\t\t\t\t`${logs.user.tag} (<@${logs.user.id}>) Added <@${logs.target.id}> (${logs.target.id}) to the ticket n째${logs.ticketId} (<#${logs.ticketChannelId}>)`\n\t\t\t);\n\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"User Added\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/G6QPFBV.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n\tif (logs.LogType === \"userRemoved\") {\n\t\tconst embed = new Discord.EmbedBuilder()\n\t\t\t.setColor(\"#ed4245\")\n\t\t\t.setAuthor({ name: logs.user.tag, iconURL: logs.user.displayAvatarURL() })\n\t\t\t.setDescription(\n\t\t\t\t`${logs.user.tag} (<@${logs.user.id}>) Removed <@${logs.target.id}> (${logs.target.id}) from the ticket n째${logs.ticketId} (<#${logs.ticketChannelId}>)`\n\t\t\t);\n\t\twebhook\n\t\t\t.send({\n\t\t\t\tusername: \"User Removed\",\n\t\t\t\tavatarURL: \"https://i.imgur.com/eFJ8xxC.png\",\n\t\t\t\tembeds: [embed],\n\t\t\t})\n\t\t\t.catch((e) => console.log(e));\n\t}\n};\n\n/*\nCopyright 2023 Sayrix (github.com/Sayrix)\n\nLicensed under the Creative Commons Attribution 4.0 International\nplease check https://creativecommons.org/licenses/by/4.0 for more informations.\n*/\n"]}