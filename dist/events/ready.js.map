{"version":3,"file":"ready.js","sourceRoot":"/","sources":["events/ready.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\nimport readline from \"readline\";\nimport axios from \"axios\";\nimport {client as WebSocketClient, connection} from \"websocket\";\nimport {ActionRowBuilder, ButtonBuilder, ButtonStyle, ColorResolvable, EmbedBuilder, Message} from \"discord.js\";\nimport os from \"os\";\nimport {BaseEvent, ExtendedClient, SponsorType} from \"../structure\";\n\n/*\nCopyright 2023 Sayrix (github.com/Sayrix)\n\nLicensed under the Creative Commons Attribution 4.0 International\nplease check https://creativecommons.org/licenses/by/4.0 for more informations.\n*/\n\nexport default class ReadyEvent extends BaseEvent {\n\tprivate connected = false;\n\tconstructor(client: ExtendedClient) {\n\t\tsuper(client);\n\t}\n\n\tpublic async execute()  {\n\t\tif (!this.client.config.guildId) {\n\t\t\tconsole.log(\"⚠️⚠️⚠️ Please add the guild id in the config.jsonc file. ⚠️⚠️⚠️\");\n\t\t\tprocess.exit(0);\n\t\t}\n\n\t\tawait this.client.guilds.fetch(this.client.config.guildId);\n\t\tawait this.client.guilds.cache.get(this.client.config.guildId)?.members.fetch();\n\t\tif (!this.client.guilds.cache.get(this.client.config.guildId)?.members.me?.permissions.has(\"Administrator\")) {\n\t\t\tconsole.log(\"\\n⚠️⚠️⚠️ I don't have the Administrator permission, to prevent any issues please add the Administrator permission to me. ⚠️⚠️⚠️\");\n\t\t\tprocess.exit(0);\n\t\t}\n\n\t\tconst embedMessageId = (await this.client.prisma.config.findUnique({\n\t\t\twhere: {\n\t\t\t\tkey: \"openTicketMessageId\",\n\t\t\t}\n\t\t}))?.value;\n\t\tawait this.client.channels.fetch(this.client.config.openTicketChannelId).catch(() => {\n\t\t\tconsole.error(\"The channel to open tickets is not found!\");\n\t\t\tprocess.exit(0);\n\t\t});\n\t\tconst openTicketChannel = await this.client.channels.cache.get(this.client.config.openTicketChannelId);\n\t\tif (!openTicketChannel) {\n\t\t\tconsole.error(\"The channel to open tickets is not found!\");\n\t\t\tprocess.exit(0);\n\t\t}\n\n\t\tif (!openTicketChannel.isTextBased()) {\n\t\t\tconsole.error(\"The channel to open tickets is not a channel!\");\n\t\t\tprocess.exit(0);\n\t\t}\n\t\tconst locale = this.client.locales;\n\t\tlet footer = locale.getSubValue(\"embeds\", \"openTicket\", \"footer\", \"text\").replace(\"ticket.pm\", \"\");\n\t\t// Please respect the project by keeping the credits, (if it is too disturbing you can credit me in the \"about me\" of the bot discord)\n\t\tfooter = `ticket.pm ${footer.trim() !== \"\" ? `- ${footer}` : \"\"}`; // Please respect the LICENSE :D\n\t\t// Please respect the project by keeping the credits, (if it is too disturbing you can credit me in the \"about me\" of the bot discord)\n\t\tconst embed = new EmbedBuilder({\n\t\t\t...locale.getSubRawValue(\"embeds.openTicket\") as object,\n\t\t\tcolor: 0,\n\t\t})\n\t\t\t.setColor(\n\t\t\t\tlocale.getNoErrorSubValue(\"embeds\", \"openTicket\", \"color\") as ColorResolvable | undefined ??\n\t\t\t\tthis.client.config.mainColor\n\t\t\t)\n\t\t\t.setFooter({\n\t\t\t\ttext: footer,\n\t\t\t\ticonURL: locale.getNoErrorSubValue(\"embeds.openTicket.footer.iconURL\")\n\t\t\t});\n\n\t\tconst row = new ActionRowBuilder<ButtonBuilder>().addComponents(\n\t\t\tnew ButtonBuilder().setCustomId(\"openTicket\").setLabel(this.client.locales.getSubValue(\"other\", \"openTicketButtonMSG\")).setStyle(ButtonStyle.Primary)\n\t\t);\n\n\t\ttry {\n\t\t\t// Fetch Message object and return undefined if not found\n\t\t\tconst msg = embedMessageId ? await (()=> new Promise<Message | undefined>((res)=> {\n\t\t\t\topenTicketChannel?.messages?.fetch(embedMessageId)\n\t\t\t\t\t.then(msg=>res(msg))\n\t\t\t\t\t.catch(()=>res(undefined));\n\t\t\t}))() : undefined;\n\t\t\t\n\t\t\tif (msg && msg.id) {\n\t\t\t\tmsg.edit({\n\t\t\t\t\tembeds: [embed],\n\t\t\t\t\tcomponents: [row]\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst channel = this.client.channels.cache.get(this.client.config.openTicketChannelId);\n\t\t\t\tif(!channel || !channel.isTextBased()) return console.error(\"Invalid openTicketChannelId\");\n\t\t\t\tchannel.send({\n\t\t\t\t\tembeds: [embed],\n\t\t\t\t\tcomponents: [row]\n\t\t\t\t}).then((rMsg) => {\n\t\t\t\t\tthis.client.prisma.config.upsert({\n\t\t\t\t\t\tcreate: {\n\t\t\t\t\t\t\tkey: \"openTicketMessageId\",\n\t\t\t\t\t\t\tvalue: rMsg.id\n\t\t\t\t\t\t},\n\t\t\t\t\t\tupdate: {\n\t\t\t\t\t\t\tvalue: rMsg.id\n\t\t\t\t\t\t},\n\t\t\t\t\t\twhere: {\n\t\t\t\t\t\t\tkey: \"openTicketMessageId\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(); // I need .then() for it to execute?!?!??\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\n\n\t\tthis.setStatus();\n\t\tsetInterval(()=>this.setStatus(), 9e5); // 15 minutes\n\n\t\treadline.cursorTo(process.stdout, 0);\n\t\tprocess.stdout.write(\n\t\t\t`\\x1b[0m🚀  The bot is ready! Logged in as \\x1b[37;46;1m${this.client.user?.tag}\\x1b[0m (\\x1b[37;46;1m${this.client.user?.id}\\x1b[0m)\n\t\t\\x1b[0m🌟  You can leave a star on GitHub: \\x1b[37;46;1mhttps://github.com/Sayrix/ticket-bot \\x1b[0m\n\t\t\\x1b[0m⛅  Host your ticket-bot by being a sponsor from 1$/month: \\x1b[37;46;1mhttps://github.com/sponsors/Sayrix \\x1b[0m\\n`.replace(/\\t/g, \"\")\n\t\t);\n\n\t\tconst a = await axios.get(\"https://raw.githubusercontent.com/Sayrix/sponsors/main/sponsors.json\").catch(() => {return;});\n\t\tif (a) {\n\t\t\tconst sponsors: SponsorType[] = a.data;\n\t\t\tconst sponsorsList = sponsors\n\t\t\t\t.map((s) => `\\x1b]8;;https://github.com/${s.sponsor.login}\\x1b\\\\\\x1b[1m${s.sponsor.login}\\x1b]8;;\\x1b\\\\\\x1b[0m`)\n\t\t\t\t.join(\", \");\n\t\t\tprocess.stdout.write(`\\x1b[0m💖  Thanks to our sponsors: ${sponsorsList}\\n`);\n\t\t}\n\n\n\t\tif ((await this.client.prisma.config.findUnique({\n\t\t\twhere: {\n\t\t\t\tkey: \"firstStart\",\n\t\t\t}\n\t\t})) === null) {\n\t\t\tawait this.client.prisma.config.create({\n\t\t\t\tdata: {\n\t\t\t\t\tkey: \"firstStart\",\n\t\t\t\t\tvalue: \"true\",\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(!this.client.config.minimalTracking) console.warn(`\n\t\t\t\tPRIVACY NOTICES\n\t\t\t\t-------------------------------\n\t\t\t\tTelemetry is current set to full and the following information are sent to the server anonymously:\n\t\t\t\t* Discord Bot's number of guilds & users\n\t\t\t\t* Current Source Version\n\t\t\t\t* NodeJS Version\n\t\t\t\t* OS Version\n\t\t\t\t* CPU version, name, core count, architecture, and model\n\t\t\t\t* Current Process up-time\n\t\t\t\t* System total ram and freed ram\n\t\t\t\t* Client name and id\n\t\t\t\t* Guild ID\n\t\t\t\t-------------------------------\n\t\t\t\tIf you wish to minimize the information that are being sent, please set \"minimalTracking\" to true in the config\n\t\t`.replace(/\\t/g, \"\"));\n\t\t\telse console.warn(`\n\t\t\t\tPRIVACY NOTICES\n\t\t\t\t-------------------------------\n\t\t\t\tMinimal tracking has been enabled; the following information are sent anonymously:\n\t\t\t\t* Current Source Version\n\t\t\t\t* NodeJS Version\n\t\t\t\t-------------------------------\n\t\t`.replace(/\\t/g, \"\"));\n\t\t}\n\n\t\tthis.connect(this.client.config.showWSLog);\n\n\t\tthis.client.deployCommands();\n\t}\n\n\tprivate setStatus(): void {\n\t\tif (this.client.config.status) {\n\t\t\tif (!this.client.config.status.enabled) return;\n\n\t\t\tlet type = 0;\n\t\t\tswitch(this.client.config.status.type) {\n\t\t\tcase \"PLAYING\":\n\t\t\t\ttype = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"STREAMING\":\n\t\t\t\ttype = 1;\n\t\t\t\tbreak;\n\t\t\tcase \"LISTENING\":\n\t\t\t\ttype = 2;\n\t\t\t\tbreak;\n\t\t\tcase \"WATCHING\":\n\t\t\t\ttype = 3;\n\t\t\t\tbreak;\n\t\t\tcase \"COMPETING\":\n\t\t\t\ttype = 4;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (this.client.config.status.type && this.client.config.status.text) {\n\t\t\t\t// If the user just want to set the status but not the activity\n\t\t\t\tconst url = this.client.config.status.url;\n\t\t\t\tthis.client.user?.setPresence({\n\t\t\t\t\tactivities: [{ name: this.client.config.status.text, type: type, url: (url && url.trim() !== \"\") ? url : undefined }],\n\t\t\t\t\tstatus: this.client.config.status.status,\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.client.user?.setStatus(this.client.config.status.status);\n\t\t}\n\t}\n\n\tprivate connect(enableLog?: boolean): void {\n\t\tif (this.connected) return;\n\t\tconst ws = new WebSocketClient();\n\t\tws.on(\"connectFailed\", (e) => {\n\t\t\tthis.connected = false;\n\t\t\tsetTimeout(()=>this.connect(enableLog), Math.random() * 1e4);\n\t\t\tif(enableLog)\n\t\t\t\tconsole.log(`❌  WebSocket Error: ${e.toString()}`);\n\t\t});\n\n\t\tws.on(\"connect\", (connection) => {\n\t\t\tconnection.on(\"error\", (e) => {\n\t\t\t\tthis.connected = false;\n\t\t\t\tsetTimeout(()=>this.connect(enableLog), Math.random() * 1e4);\n\t\t\t\tif(enableLog)\n\t\t\t\t\tconsole.log(`❌  WebSocket Error: ${e.toString()}`);\n\t\t\t});\n\n\t\t\tconnection.on(\"close\", (e) => {\n\t\t\t\tthis.connected = false;\n\t\t\t\tsetTimeout(()=>this.connect(enableLog), Math.random() * 1e4);\n\t\t\t\tif(enableLog)\n\t\t\t\t\tconsole.log(`❌  WebSocket Error: ${e.toString()}`);\n\t\t\t});\n\n\t\t\tthis.connected = true;\n\t\t\tif(enableLog)\n\t\t\t\tconsole.log(\"✅  Connected to WebSocket server.\");\n\t\t\tthis.telemetry(connection);\n\n\t\t\tsetInterval(() => {\n\t\t\t\tthis.telemetry(connection);\n\t\t\t}, 120_000);\n\t\t});\n\n\t\tws.connect(\"wss://ws.ticket.pm\", \"echo-protocol\");\n\n\t}\n\n\tprivate telemetry(connection: connection) {\n\t\tlet fullInfo: {[key:string]: string | number | {[key:string]: string | number}} = {\n\t\t\tos: os.platform(),\n\t\t\tosVersion1: os.release(),\n\t\t\tosVersion2: os.version(),\n\t\t\tuptime: process.uptime(),\n\t\t\tram: {\n\t\t\t\ttotal: os.totalmem(),\n\t\t\t\tfree: os.freemem()\n\t\t\t},\n\t\t\tcpu: {\n\t\t\t\tmodel: os.cpus()[0].model,\n\t\t\t\tcores: os.cpus().length,\n\t\t\t\tarch: os.arch()\n\t\t\t}\n\t\t};\n\t\tlet moreInfo: {[key:string]: string | undefined} = {\n\t\t\tclientName: this.client?.user?.tag,\n\t\t\tclientId: this.client?.user?.id,\n\t\t\tguildId: this.client?.config?.guildId\n\t\t};\n\t\t// Minimal tracking enabled, remove those info from being sent\n\t\tif(this.client.config.minimalTracking) {\n\t\t\tfullInfo = {};\n\t\t\tmoreInfo = {};\n\t\t}\n\t\tconnection.sendUTF(\n\t\t\tJSON.stringify({\n\t\t\t\ttype: \"telemetry\",\n\t\t\t\tdata: {\n\t\t\t\t\tstats: {\n\t\t\t\t\t\tguilds: this.client?.guilds?.cache?.size,\n\t\t\t\t\t\tusers: this.client?.users?.cache?.size\n\t\t\t\t\t},\n\t\t\t\t\tinfos: {\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-var-requires\n\t\t\t\t\t\tticketbotVersion: require(\"../../package.json\").version,\n\t\t\t\t\t\tnodeVersion: process.version,\n\t\t\t\t\t\t...fullInfo\n\t\t\t\t\t},\n\t\t\t\t\t...moreInfo\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n}\n\n/*\nCopyright 2023 Sayrix (github.com/Sayrix)\n\nLicensed under the Creative Commons Attribution 4.0 International\nplease check https://creativecommons.org/licenses/by/4.0 for more informations.\n*/"]}